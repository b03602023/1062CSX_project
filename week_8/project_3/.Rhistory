b3 <-
ggplot(data, aes(x = sibsp, fill = sex)) +
geom_bar(stat='count', position = 'dodge') +
geom_label(stat = 'count', aes(label =..count..), size = 5,
position=position_dodge(0.9))+
theme_grey(base_size = 15)
b4 <-
ggplot(data, aes(x = sibsp, fill = survived)) +
geom_bar(stat='count', position='fill') +
labs(x = 'pclass', y= "Percent") + facet_grid(.~sex) +
theme(legend.position="none") + theme_grey()
b1
b2
b3
b4
b3
b2
b3
b2
b1
b2
b3
b4
b4
b1 <- ggplot(data, aes(x = parch, fill = parch)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=8) +
theme_grey(base_size = 15)
b2 <-
ggplot(data, aes(x = parch, fill = survived)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=8, position=position_dodge(0.9)) +
theme_grey(base_size = 15)
b1
b2
b1
ggplot(data, aes(x = parch, fill = parch)) +
geom_bar(stat='count', position='dodge') +
facet_grid(.~sex) +
geom_label(stat='count',aes(label=..count..), size=8) +
theme_grey(base_size = 15)
ggplot(data, aes(x = parch, fill = survived)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=8, position=position_dodge(0.9)) +
facet_grid(.~sex) +
theme_grey(base_size = 15)
ggplot(data, aes(x = parch, fill = survived)) +
geom_bar(stat='count', position='fill') +
labs(x = 'pclass', y= "Percent") + facet_grid(.~sex) +
theme(legend.position="none") + theme_grey()
ggplot(data, aes(x = sibsp, fill = survived)) +
geom_bar(stat='count', position='fill') +
labs(x = 'sibsp', y= "Percent") + facet_grid(.~sex) +
theme(legend.position="none") + theme_grey()
ggplot(data, aes(x = parch, fill = parch)) +
geom_bar(stat='count', position='dodge') +
facet_grid(.~sex) +
geom_label(stat='count',aes(label=..count..), size=8) +
theme_grey(base_size = 15)
# ------------ age----------
# 男性存活率最高的在5歲以下
# 女性則是大部分都存活率極高
ggplot(data, aes(x = age, fill = survived)) +
geom_histogram(aes(fill=factor(survived))) + labs(title="Survival density, known-ages, and sex") +
scale_x_continuous(breaks = scales::pretty_breaks(n = 12)) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 12)) +
theme_grey() + facet_grid(.~sex)
#-------fare--------
#
#
ggplot(data, aes(x = fare, fill = survived)) +
geom_histogram(aes(fill=factor(survived))) + labs(title="Survival density, known-ages, and sex") +
scale_x_continuous(breaks = scales::pretty_breaks(n = 12)) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 12)) +
theme_grey() + facet_grid(.~sex)
# ------- family size -------
data$fs <- data$parch+data$sibsp
data$parch
data$sibsp
as.character(data$parch)+as.character(data$sibsp)
# ------- family size -------
data$fs <- as.numeric(data$parch)+as.numeric(data$sibsp)
data$fs
View(data)
data$parch
class(data$parch)
mode(data$parch)
data$parch + 1
length(data$parch)
nrow(data)
as.numeric(data$sibsp)
data$sibsp
data$sibsp[1:12]
data$parch[1:12]
(data$parch+data$sibsp)[1:12]
(as.numeric(data$parch)+as.numeric(data$sibsp))[1:12]
data <- read.csv("titanicTrain.csv")
# 去除NA
# 整理資料格式
data <- data[1:1000,]
class(data$parch)
mode(data$parch)
ggplot(data, aes(x = survived, fill = survived)) +
geom_bar(stat='count', position='dodge') +
labs(x = 'How many people died and survived on the Titanic?') +
geom_label(stat='count',aes(label=..count..), size=4) +
theme_grey(base_size = 15)
#------- gender/sex-----------
b1 <- ggplot(data, aes(x = pclass)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=8) +
facet_grid(.~sex) +
theme_grey(base_size = 15)
b1
b2 <-
ggplot(data, aes(x = pclass, fill = survived)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=8, position = position_dodge(0.9)) +
labs(x = 'pclass', y= "count") + facet_grid(.~sex) +
theme(legend.position="none") + theme_grey()
b2
data$sibsp
data$sibsp[1:12]
data$parch[1:12]
(as.integer(data$parch)+as.integer(data$sibsp))[1:12]
data%sibsp
data$sibsp
data$boat <- as.character(data$boat)
data$survived <- as.factor(data$survived)
data$pclass <- as.factor(data$pclass)
data$sibsp <- as.factor(data$sibsp)
data$parch <- as.factor(data$parch)
(as.integer(data$parch)+as.integer(data$sibsp))[1:12]
data$sibsp[1:12]
data$parch[1:12]
data <- read.csv("titanicTrain.csv")
# 去除NA
# 整理資料格式
data <- data[1:1000,]
sapply(data, function(x) {sum(is.na(x))})
data <- subset(data, select = -body)
data <- data[is.na(data$age)!=TRUE,]
data$fs <- as.integer(data$parch)+as.integer(data$sibsp)
data$boat <- as.character(data$boat)
data$survived <- as.factor(data$survived)
data$pclass <- as.factor(data$pclass)
data$sibsp <- as.factor(data$sibsp)
data$parch <- as.factor(data$parch)
summary(data)
summary(data)
View(summary(data))
data <- read.csv("titanicTrain.csv")
# 去除NA
# 整理資料格式
data <- data[1:1000,]
summary(data)
summary(pclass)
summary(data$pclass)
summary(pclass)
summary(data)
data <- read.csv("titanicTrain.csv")
# 去除NA
# 整理資料格式
data <- data[1:1000,]
sapply(data, function(x) {sum(is.na(x))})
data <- subset(data, select = -body)
data <- data[is.na(data$age)!=TRUE,]
data$fs <- as.integer(data$parch)+as.integer(data$sibsp)
data$boat <- as.character(data$boat)
data$survived <- as.factor(data$survived)
data$pclass <- as.factor(data$pclass)
data$sibsp <- as.factor(data$sibsp)
data$parch <- as.factor(data$parch)
summary(data)
# EDA
??grid.arrange
library(gridExtra)
data <- read.csv("titanicTrain.csv")
# 去除NA
# 整理資料格式
data <- data[1:1000,]
sapply(data, function(x) {sum(is.na(x))})
data <- subset(data, select = -body)
data <- data[is.na(data$age)!=TRUE,]
data$fs <- as.integer(data$parch)+as.integer(data$sibsp)
data$boat <- as.character(data$boat)
data$survived <- as.factor(data$survived)
data$pclass <- as.factor(data$pclass)
data$sibsp <- as.factor(data$sibsp)
data$parch <- as.factor(data$parch)
summary(data)
# EDA
library(ggplot2)
library(scales)
library(gridExtra)
#----- parch-------------
#-----男性生存比例偏低，但若在sibsp為1和2之間的生存率有接近0.5
#------女性的生存率在sibsp為5以前都很高。
# 注意: parch為parch為2以前的樣本量較多。
b1 <- ggplot(data, aes(x = parch, fill = parch)) +
geom_bar(stat='count', position='dodge') +
facet_grid(.~sex) +
geom_label(stat='count',aes(label=..count..), size=8) +
theme_grey(base_size = 15)
b2 <-
ggplot(data, aes(x = parch, fill = survived)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=8, position=position_dodge(0.9)) +
facet_grid(.~sex) +
theme_grey(base_size = 15)
ggplot(data, aes(x = parch, fill = survived)) +
geom_bar(stat='count', position='fill') +
labs(x = 'parch', y= "Percent") + facet_grid(.~sex) +
theme(legend.position="none") + theme_grey()
grid.arrange(b1,b2, nrow=1)
# ------- family size -------
# total statistics
b1 <- ggplot(data, aes(x = fs, fill = fs)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=5) +
theme_grey(base_size = 15)
# statistics showing survival with sex difference
b2 <-
ggplot(data, aes(x = fs, fill = survived)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=5, position=position_dodge(0.9)) +
facet_grid(.~sex) +
theme_grey(base_size = 15)
# total statistics with sex difference
b3 <-
ggplot(data, aes(x = fs, fill = sex)) +
geom_bar(stat='count', position = 'dodge') +
geom_label(stat = 'count', aes(label =..count..), size = 5,
position=position_dodge(0.9))+
theme_grey(base_size = 15)
# percent statistics showing survival with sex difference
b4 <-
ggplot(data, aes(x = fs, fill = survived)) +
geom_bar(stat='count', position='fill') +
labs(x = 'sibsp', y= "Percent") + facet_grid(.~sex) +
theme(legend.position="none") + theme_grey()
grid.arrange(b1,b2,b3,b4, nrow=2)
# ------- family size -------
# total statistics
b1 <- ggplot(data, aes(x = fs, fill = fs)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=5) +
theme_grey(base_size = 15)
# statistics showing survival with sex difference
b2 <-
ggplot(data, aes(x = fs, fill = survived)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=5, position=position_dodge(0.9)) +
facet_grid(.~sex) +
theme_grey(base_size = 15)
# total statistics with sex difference
b3 <-
ggplot(data, aes(x = fs, fill = sex)) +
geom_bar(stat='count', position = 'dodge') +
geom_label(stat = 'count', aes(label =..count..), size = 5,
position=position_dodge(0.9))+
theme_grey(base_size = 15)
# percent statistics showing survival with sex difference
b4 <-
ggplot(data, aes(x = fs, fill = survived)) +
geom_bar(stat='count', position='fill') +
labs(x = 'sibsp', y= "Percent") + facet_grid(.~sex) +
theme(legend.position="none") + theme_grey()
grid.arrange(b1,b2,b3,b4, nrow=2)
# ------- family size -------
# total statistics
b1 <- ggplot(data, aes(x = fs, fill = fs)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=5) +
theme_grey(base_size = 15)
# statistics showing survival with sex difference
b2 <-
ggplot(data, aes(x = fs, fill = survived)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=5, position=position_dodge(0.9)) +
facet_grid(.~sex) +
theme_grey(base_size = 15)
# total statistics with sex difference
b3 <-
ggplot(data, aes(x = fs, fill = sex)) +
geom_bar(stat='count', position = 'dodge') +
geom_label(stat = 'count', aes(label =..count..), size = 5,
position=position_dodge(0.9))+
theme_grey(base_size = 15)
# percent statistics showing survival with sex difference
b4 <-
ggplot(data, aes(x = fs, fill = survived)) +
geom_bar(stat='count', position='fill') +
labs(x = 'sibsp', y= "Percent") + facet_grid(.~sex) +
theme(legend.position="none") + theme_grey()
grid.arrange(b1,b2,b3,b4, nrow=2)
b1
b2
b3
b4
grid.arrange(b1,b2,b3,b4, nrow=2)
data <- read.csv("titanicTrain.csv")
# 去除NA
# 整理資料格式
data <- data[1:1000,]
sapply(data, function(x) {sum(is.na(x))})
data <- subset(data, select = -body)
data <- data[is.na(data$age)!=TRUE,]
data$fs <- as.integer(data$parch)+as.integer(data$sibsp)+1
data$boat <- as.character(data$boat)
data$survived <- as.factor(data$survived)
data$pclass <- as.factor(data$pclass)
data$sibsp <- as.factor(data$sibsp)
data$parch <- as.factor(data$parch)
data$fs <- as.factor(data$fs)
summary(data)
# ------- family size -------
# -----family size為3的男生存活率最高
# total statistics
b1 <- ggplot(data, aes(x = fs, fill = fs)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=5) +
theme_grey(base_size = 15)
# statistics showing survival with sex difference
b2 <-
ggplot(data, aes(x = fs, fill = survived)) +
geom_bar(stat='count', position='dodge') +
geom_label(stat='count',aes(label=..count..), size=5, position=position_dodge(0.9)) +
facet_grid(.~sex) +
theme_grey(base_size = 15)
# total statistics with sex difference
b3 <-
ggplot(data, aes(x = fs, fill = sex)) +
geom_bar(stat='count', position = 'dodge') +
geom_label(stat = 'count', aes(label =..count..), size = 5,
position=position_dodge(0.9))+
theme_grey(base_size = 15)
# percent statistics showing survival with sex difference
b4 <-
ggplot(data, aes(x = fs, fill = survived)) +
geom_bar(stat='count', position='fill') +
labs(x = 'sibsp', y= "Percent") + facet_grid(.~sex) +
theme(legend.position="none") + theme_grey()
grid.arrange(b1,b2,b3,b4, nrow=2)
# ------------ age----------
# 男性存活率最高的在5歲以下
# 女性則是大部分都存活率極高
ggplot(data, aes(x = age, fill = survived)) +
geom_histogram(aes(fill=factor(survived))) + labs(title="Survival density, known-ages, and sex") +
scale_x_continuous(breaks = scales::pretty_breaks(n = 12)) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 12)) +
theme_grey() + facet_grid(.~sex)
#-------fare--------
#
#
ggplot(data, aes(x = fare, fill = survived)) +
geom_histogram(aes(fill=factor(survived))) + labs(title="Survival density, known-ages, and sex") +
scale_x_continuous(breaks = scales::pretty_breaks(n = 12)) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 12)) +
theme_grey() + facet_grid(.~sex)
ggplot(data, aes(x = age, fill = survived)) +
geom_histogram(aes(fill=factor(survived))) + labs(title="Survival density, known-ages, and sex") +
scale_x_continuous(breaks = scales::pretty_breaks(n = 12)) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 12)) +
theme_grey() + facet_grid(.~sex)
# age 越小，越有可能上船 (但不一定會存活?)
par(mfrow=c(1,2))
hist(data$age[data$survived==1], main = "the age histogram for those who were survived"
,xlab="age")
par(pch=19)
plot(data$age, data$fare)
points(data$age[data$survived==1], data$fare[data$survived==1], col="red") #活下
points(data$age[data$survived==1 & data$sibsp!=0 & data$parch!=0],
data$fare[data$survived==1 & data$sibsp!=0 & data$parch!=0], col="yellow")
points(data$age[data$survived==1 & data$sibsp!=0 & data$parch!=0 & data$sex=="female"], data$fare[data$survived==1 & data$sibsp!=0 & data$parch!=0 & data$sex=="female"],
col="green")
data$fare[data$survived==1]
hist(data$fare[data$survived==1], main="histogram of fares of survived people")
summary(data$fare[data$survived==1])
summary(data$fare)
hist(data$fare[data$survived==1], main="histogram of fares of survived people")
summary(data$fare[data$survived==1])
summary(data$fare)
ggplot(data, aes(x = fare, fill = survived)) +
geom_histogram(aes(fill=factor(survived))) + labs(title="Survival density, known-ages, and sex") +
scale_x_continuous(breaks = scales::pretty_breaks(n = 12)) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 12)) +
theme_grey() + facet_grid(.~sex)
is.na(data$fare)
length(is.na(data$fare))
par(mfrow=c(1,2))
hist(data$age[data$survived==1], main = "the age histogram for those who were survived"
,xlab="age")
summary(data$age[data$survived==1])
hist(data$age[data$survived==1], main = "the age histogram for those who were survived"
,xlab="age")
# ------------ age----------
# 男性存活率最高的在5歲以下
# 女性則是大部分都存活率極高
ggplot(data, aes(x = age, fill = survived)) +
geom_histogram(aes(fill=factor(survived))) + labs(title="Survival density, known-ages, and sex") +
scale_x_continuous(breaks = scales::pretty_breaks(n = 12)) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 12)) +
theme_grey() + facet_grid(.~sex)
ggplot(data, aes(x = fare, fill = survived)) +
geom_histogram(aes(fill=factor(survived))) + labs(title="Survival density, known-ages, and sex") +
scale_x_continuous(breaks = scales::pretty_breaks(n = 12)) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 12)) +
theme_grey() + facet_grid(.~sex)
boxplot(data$sibsp, range=2, main="sibsp")
par(pch=19)
plot(data$age, data$fare)
points(data$age[data$survived==1], data$fare[data$survived==1], col="red") #活下
points(data$age[data$survived==1 & data$sibsp!=0 & data$parch!=0],
data$fare[data$survived==1 & data$sibsp!=0 & data$parch!=0], col="yellow")
points(data$age[data$survived==1 & data$sibsp!=0 & data$parch!=0 & data$sex=="female"], data$fare[data$survived==1 & data$sibsp!=0 & data$parch!=0 & data$sex=="female"],
col="green")
length(data$age[data$survived==1 & data$sibsp!=0 & data$parch!=0& data$sex=="female"])/length(data$age[data$survived==1 & data$sibsp!=0 & data$parch!=0])
length(data$age[data$survived==0 & data$sibsp!=0 & data$parch!=0& data$sex=="male"])/length(data$age[data$survived==0 & data$sibsp!=0 & data$parch!=0])
#活下且有兄弟姊妹親人是女性的比例是
length(data$age[data$survived==1 & data$sibsp!=0 & data$parch!=0& data$sex=="female"])/length(data$age[data$survived==1 & data$sibsp!=0 & data$parch!=0])
length(data$age[data$survived==0 & data$sibsp!=0 & data$parch!=0& data$sex=="male"])/length(data$age[data$survived==0 & data$sibsp!=0 & data$parch!=0])
?train
# titanic
library(e1071)
?train
??train
# titanic
library(e1071)
e1071::train
train
train(Survived~ PclassSex + FarePP + AnySurvivors + IsChildP12 + IsSolo,
data=trainClean, method='svmRadial', preProcess= c('center', 'scale'),
trControl=trainControl(method="cv", number=5))
?SVMtrain
svm(survived~ pclass + fare + fs,
data=data, method='svmRadial', preProcess= c('center', 'scale'),
trControl=trainControl(method="cv", number=5))
svm_pred <- svm(survived~ pclass + fare + fs,
data=data, method='svmRadial', preProcess= c('center', 'scale'),
trControl=trainControl(method="cv", number=5))
plot(svm_pred)
svm_model <- svm(survived~ pclass + fare + fs,
data=data, method='svmRadial', preProcess= c('center', 'scale'),
trControl=trainControl(method="cv", number=5))
plot(svm_model)
svm_model <- svm(survived~ pclass + fare + fs,
data=data, method='svmRadial', cost = 100, gamma = 1)
plot(svm_model)
plot(svm_model, data)
svm_model <- svm(survived~ pclass + fare + fs,
data=data, method='svmRadial', cost = 100, gamma = 1)
plot(svm_model, data)
svm_model
tdata <- subset(data, select = c(survived, pclass, fare, fs))
tdata
ncol(tdata)
summary(tdata)
tdata <- subset(data, select = c(pclass, fare, fs, survived))
svm_model <- svm(survived~ pclass + fare + fs,
data=tdata, method='svmRadial', cost = 100, gamma = 1)
plot(svm_model, data)
tdata <- subset(data, select = c(pclass, fare, fs, survived))
svm_model <- svm(survived~ ,
data=tdata, method='svmRadial', cost = 100, gamma = 1)
plot(svm_model, data)
tdata <- subset(data, select = c(pclass, fare, fs, survived))
svm_model <- svm(survived ~ ., data=tdata, method='svmRadial', cost = 100, gamma = 1)
plot(svm_model, data)
svm_model <- svm(survived ~ ., data=tdataa)
plot(svm_model, data)
tdata <- subset(data, select = c(pclass, fare, fs, survived))
svm_model <- svm(survived ~ ., data=tdata)
plot(svm_model, data)
plot(svm_model, tdata, age ~ sibsp,
slice = list(age = 3, sibsp= 4),color.palette = terrain.colors)
plot(svm_model, tdata, pclass ~ age,
slice = list(age = 3, sibsp= 4),color.palette = terrain.colors)
plot(svm_model, tdata, pclass ~ fare,
slice = list(age = 3, sibsp= 4),color.palette = terrain.colors)
# titanic
library(e1071)
tdata <- subset(data, select = c(pclass, fare, fs, survived))
svm_model <- svm(survived ~ ., data=tdata)
svm_pred <- predict(svm_model)
table(svm_pred, data$survived)
plot(svm_model, tdata, pclass ~ fare,
slice = list(age = 3, sibsp= 4),color.palette = terrain.colors)
svm_pred
length(svm_pred)
length(tdata)
nrow(tdata)
length(svm_pred)
summary(svm_pred)
summary(data)
summary(data$survived)
summary(svm_pred)
svm_[1:10]
svm_pred[1:10]
data$survived[1:10]
table(svm_pred, data$survived)
plot(svm_model, tdata, pclass ~ fare,
slice = list(age = 3, sibsp= 4),color.palette = terrain.colors)
plot(svm_model, tdata, pclass ~ fare)
plot(svm_model)
plot(svm_model, tdata)
plot(svm_model, tdata, survived ~ fare)
plot(svm_model, tdata, survived ~ fare + pclass + fs)
survived ~ fare + pclass + fs
tdata
length(tdata)
nrow(tdata)
