---
title: "week3_practice for ggplot and ggmap"
author: 沈祐珍
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 獨立特色書店的點擊數與其空間關係圖


#####各書店的資訊：
顯示前6個和後6個

```{r}
library(jsonlite)
url <- "https://cloud.culture.tw/frontsite/trans/emapOpenDataAction.do?method=exportEmapJson&typeId=M"
my.data <- fromJSON(url)
```

***

```{r, echo=FALSE}
library(knitr)
kable(head(my.data[ ,c(1,5,13,24)]))
```
.
.
.
```{r, echo=FALSE}
library(knitr)
kable(tail(my.data[ ,c(1,5,13,24)]))
```

***


#####按點擊數由大至小排序各書店的點擊數：
顯示前6個和後6個

***
```{r, echo=FALSE}
library(knitr)
kable(head(my.data[order(my.data$hitRate, decreasing = TRUE), c(1,5,13,24) ]))
```
.
.
.
```{r, echo=FALSE}
library(knitr)
kable(tail(my.data[order(my.data$hitRate, decreasing = TRUE), c(1,5,13,24) ]))
```

***

#####ggplot2 and ggmap

```{r}
library(plotly)
library(ggmap)
my.data$longitude<-as.numeric(my.data$longitude)
my.data$latitude<-as.numeric(my.data$latitude)
twmap <- get_map(location = c(121.53,25.08), zoom = 12, maptype = 'roadmap')
twmap0 <- ggmap(twmap, extent = 'device')+    #extent = 'device' 滿版
  geom_point(data = my.data, 
             aes(x = longitude, y = latitude, colour = hitRate), 
             size = 9) +
  
  scale_color_continuous(low = "yellow", high = "black")+
  guides(size = FALSE)
twmap0
```


```{r,echo=FALSE}
twmap <- get_map(location = c(121.53,25.05), zoom = 13, maptype = 'roadmap')
twmap0 <- ggmap(twmap, extent = 'device')+    #extent = 'device' 滿版
  geom_point(data = my.data, 
             aes(x = longitude, y = latitude, colour = hitRate), 
             size = 9) +
  
  scale_color_continuous(low = "yellow", high = "black")+
  guides(size = FALSE)
twmap0
```


```{r,echo=FALSE}
twmap <- get_map(location = c(121.53,25.02), zoom = 15, maptype = 'roadmap')
twmap0 <- ggmap(twmap, extent = 'device')+    #extent = 'device' 滿版
  geom_point(data = my.data, 
             aes(x = longitude, y = latitude, colour = hitRate), 
             size = 5) +
  
  scale_color_continuous(low = "yellow", high = "black")+
  guides(size = FALSE)
twmap0
```


`資料來源`：政府資料開放平台--文化部收錄獨立特色書店的資料

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
